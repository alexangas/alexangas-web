resources:
  pipelines:
  - pipeline: alexangasweb
    source: alexangas.alexangas-web-ci
    trigger:
      branches:
      - master

variables:
  System.Debug: true

jobs:
  - job: DeployTwo
    pool:
      vmImage: 'windows-latest'
    condition: succeededOrFailed()
    steps:
      - download: 'alexangasweb'
        artifact: 'drop'
      - template: ./_pwsh.yml
        parameters:
          verb: 'sync'
          source: '$(System.DefaultWorkingDirectory)'
          destination: 'https://azcopyplay.blob.core.windows.net/`$web'
          destinationsas: '?sv=2019-10-10&ss=b&srt=sco&sp=rwdlac&se=2021-04-30T23:13:25Z&st=2020-04-30T15:13:25Z&spr=https&sig=%2Bfnsun00qTpHEQ0GNYzUXUF8Mul2rji37WGrizK8hQc%3D'
          flags: '--recursive --delete-destination=true'
  - job: DeployTwoLinux
    pool:
      vmImage: 'ubuntu-latest'
    dependsOn: DeployTwo
    condition: succeededOrFailed()
    steps:
      - download: 'alexangasweb'
        artifact: 'drop'
      - template: ./_pwsh.yml
        parameters:
          verb: 'sync'
          source: '$(System.DefaultWorkingDirectory)'
          destination: 'https://azcopyplay.blob.core.windows.net/`$web'
          destinationsas: '?sv=2019-10-10&ss=b&srt=sco&sp=rwdlac&se=2021-04-30T23:13:25Z&st=2020-04-30T15:13:25Z&spr=https&sig=%2Bfnsun00qTpHEQ0GNYzUXUF8Mul2rji37WGrizK8hQc%3D'
          flags: '--delete-destination=true'
